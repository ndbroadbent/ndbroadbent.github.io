<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="map[]" />
    <meta name="description" content="Home automation, electronics, software development, etc.">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="theme-color" content="#ffffff">

    <title>Delete Plex TV Shows and Movies After Watching</title>
    <meta name="generator" content="Hugo 0.21" />

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Inter:400,700">
    

    <!--[if lt IE 9]>
			<script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
    <script defer data-domain="madebynathan.com" data-api="https://pa.ndbr.workers.dev/api" src="https://pa.ndbr.workers.dev/main.js"></script>
  </head>

  <body>
    <div id="wrap">

      
      
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="https://madebynathan.com/">
        Made By Nathan
      </a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="/tags/projects/">
          Projects</a>
        </li>
        
        <li><a href="/posts/">
          Posts</a>
        </li>
        
        <li><a href="/tags/">
          Tags</a>
        </li>
        
        <li><a href="https://ndbroadbent.com">
          Consulting</a>
        </li>
        
      
      </ul>
    </div>
  </div>
</nav>

      
      <div class="container single-blog-post">

        <div class="blog-post">
          <h3>
            <a href="https://madebynathan.com/posts/2022-10-10-delete-plex-tv-shows-and-movies-after-watching/">Delete Plex TV Shows and Movies After Watching</a>
          </h3>
        </div>

        <div class="tags-and-date">
          <div class="tags">
            
              <a class="tag" href="/tags/plex">plex&nbsp;&nbsp;</a>
            
              <a class="tag" href="/tags/debian">debian&nbsp;&nbsp;</a>
            
          </div>
          <div class="blog-title">
            <h4 class="post-date">
            October 10, 2022
            </h4>
          </div>
        </div>



        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              <p><a href="https://github.com/ndbroadbent/Plex-Cleaner"><code>Plex-Cleaner</code></a> is a Python script that can clean up your Plex directory by deleting movies and TV shows after you&rsquo;ve watched them. This will stop your disk from filling up with lots of old media files over time. You can run this script on your server (or Raspberry Pi, or wherever you run Plex Media Server.)</p>

<p>I like to put things in the <code>/opt</code> directory on my servers.</p>

<ul>
<li>Run <code>git clone https://github.com/ndbroadbent/Plex-Cleaner.git /opt</code></li>
<li>Run <code>python3 PlexCleaner.py --dump Cleaner.conf</code> to create a new configuration file</li>

<li><p>Configure an authentication token in <code>Cleaner.conf</code>, under the <code>&quot;Token&quot;</code> key.</p>

<ul>
<li><a href="https://support.plex.tv/articles/204059436-finding-an-authentication-token-x-plex-token/">Here&rsquo;s how to get an authentication token.</a></li>
</ul></li>

<li><p>Call <code>python3 PlexCleaner.py</code> to test it out.</p></li>
</ul>

<p>The script will run in test mode and won&rsquo;t delete anything if your <code>Cleaner.conf</code> contains <code>&quot;test&quot;: true</code>, or if you call <code>python3 PlexCleaner.py --test</code>.</p>

<ul>
<li>After everything looks good in the logs, set <code>&quot;test&quot;: false</code> in <code>Cleaner.conf</code>.</li>
</ul>

<p>You&rsquo;ll probably want to run this script regularly as a cron job. Run <code>crontab -e</code> to edit your crontab, then add the following line to run the script every day at 4am:</p>

<pre><code>0 4 * * * /usr/bin/python3 /opt/Plex-Cleaner/PlexCleaner.py
</code></pre>

<p><br/></p>

<hr />

<p>I always like to set up monitoring for any scheduled scripts so that I get a notification <del>if</del>&nbsp;when they stop working. <a href="https://healthchecks.io/">healthchecks.io</a> is my favorite monitoring tool and they have a generous free tier. <em>(No affiliation, they&rsquo;re just an awesome service.)</em></p>

<p>To set up monitoring with healthchecks.io, you can call the <code>run_plex_cleaner.sh</code> script from <a href="https://github.com/ndbroadbent/Plex-Cleaner">my fork</a>. This script will ping <a href="https://healthchecks.io/">healthchecks.io</a> on success or failure. <a href="https://healthchecks.io/">healthchecks.io</a> will also send you a notification if it doesn&rsquo;t receive any ping at the expected time (e.g. if your server has been turned off.)</p>

<ul>
<li>Sign up for a free <a href="https://healthchecks.io/">healthchecks.io</a> account.</li>
<li>Create a new check. Choose the &ldquo;Cron&rdquo; schedule and enter your cron expression, e.g. <code>0 4 * * *</code>.</li>
<li>Make sure you also set the correct Time Zone in the options.</li>
<li>Save the healthchecks.io check ID to a <code>healthchecksio_id</code> file in the <code>Plex-Cleaner</code> directory</li>
<li>Set the log file option in <code>Cleaner.conf</code> so that it writes logs to a file:</li>
</ul>

<pre><code>&quot;LogFile&quot;: &quot;/opt/Plex-Cleaner/plexcleaner.log&quot;,
</code></pre>

<ul>
<li>Set up this cron job entry (instead of the one above):</li>
</ul>

<pre><code>0 4 * * * /opt/Plex-Cleaner/run_plex_cleaner.sh
</code></pre>

<p><br/></p>

<p>Now you&rsquo;ll get an email alert whenever something goes wrong:</p>

<ul>
<li>The script exits with an error</li>
<li>The <code>plexcleaner.log</code> log file contains any <code>ERROR</code> entries</li>
<li>The script doesn&rsquo;t run at all</li>
</ul>


              <div class="related-posts">
                <h5>Related Posts</h5>
                
                  <div class="row">
                    <div class="col-sm-3 col-md-3 col-lg-3">
                      <h6 class="post-date">
                        October 7, 2022
                      </h6>
                    </div>
                    <div class="col-sm-9 col-md-9 col-lg-9">
                      <h6 style="text-align: left">
                        <a href="/posts/2022-10-07-can-you-plug-a-sata-drive-into-a-sas-controller/">Can you plug a SATA drive into a SAS controller?</a>
                      </h6>
                    </div>
                  </div>
                
              </div>
            </div>
          </div>

        <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = 'madebynathan';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        </div>
      </div>
      
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with â™¥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://madebynathan.com/js/docs.min.js"></script>
<script src="https://madebynathan.com/js/main.js"></script>

<script src="https://madebynathan.com/js/ie10-viewport-bug-workaround.js"></script>



  </body>
</html>
